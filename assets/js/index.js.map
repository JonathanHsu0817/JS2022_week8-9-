{"version":3,"sources":["index.js"],"names":["productData","cartData","productList","document","querySelector","productSelect","init","getProductList","getCartList","axios","get","api_path","then","res","data","products","renderCard","str","forEach","item","content","images","id","title","origin_price","price","innerHTML","addEventListener","e","category","target","value","tempData","push","preventDefault","addCartClass","getAttribute","productId","console","log","numberCheck","product","quantity","post","alert","finalTotal","textContent","carts","renderCart","cartList","cartId","discardAllBtn","err","orderInfoBtn","length","customerName","customerPhone","customerEmail","customerAddress","customerTradeWay","orderForm","reset"],"mappings":"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","sourcesContent":["////index section\r\nlet productData = [];\r\nlet cartData = [];\r\nconst productList = document.querySelector(\".productWrap\");\r\nconst productSelect = document.querySelector(\".productSelect\");\r\n\r\nfunction init(){\r\n    getProductList();\r\n    getCartList();\r\n};\r\n\r\ninit();\r\n\r\n//取product api裡資料\r\nfunction getProductList(){\r\n    axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/products`)\r\n      .then(res=>{\r\n        // console.log(res.data);\r\n        productData = res.data.products;\r\n        renderCard(productData);\r\n      })\r\n};\r\n\r\n\r\n//將product api資料渲染成HTML(card)\r\nfunction renderCard(data){\r\n    let str = \"\";\r\n    data.forEach(item=>{\r\n        let content = `<li class=\"productCard\">\r\n            <h4 class=\"productType\">新品</h4>\r\n            <img src=\"${item.images}\" alt=\"\">\r\n            <a href=\"#\" class=\"js-addCart\" data-id=\"${item.id}\">加入購物車</a>\r\n            <h3>${item.title}</h3>\r\n            <del class=\"originPrice\">NT${item.origin_price}</del>\r\n            <p class=\"nowPrice\">NT${item.price}</p>\r\n        </li>`\r\n        str+=content;\r\n    })\r\n    productList.innerHTML = str;\r\n}\r\n\r\n//篩選category\r\nproductSelect.addEventListener(\"change\",(e)=>{\r\n    // console.log(e.target.value);\r\n    const category = e.target.value;\r\n    if( category === \"全部\"){\r\n        renderCard(productData)\r\n    }else{\r\n        const tempData = [];\r\n        productData.forEach(item=>{\r\n            if(item.category === category){\r\n                tempData.push(item)\r\n            }\r\n        })\r\n        renderCard(tempData);\r\n    }\r\n})\r\n\r\n\r\n////購物車\r\n//點選購物車\r\nproductList.addEventListener(\"click\",(e)=>{\r\n    e.preventDefault();\r\n    let addCartClass = e.target.getAttribute(\"class\");\r\n    if(addCartClass !== \"js-addCart\"){\r\n        return;\r\n    }\r\n    let productId = e.target.getAttribute(\"data-id\");\r\n    console.log(productId)\r\n\r\n    let numberCheck = 1;\r\n    // console.log(cartData)\r\n    cartData.forEach(item =>{\r\n        if(productId === item.product.id){\r\n            item.quantity+=1;\r\n            numberCheck=item.quantity;\r\n        }\r\n        // console.log(numberCheck)\r\n    })\r\n\r\n    // 加入購物車 數量 並輸入給api\r\n    axios.post(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts`,{\r\n        \"data\": {\r\n            \"productId\": productId,\r\n            \"quantity\": numberCheck\r\n          }\r\n    }).then(res=>{\r\n            console.log(res)\r\n            alert(\"加入成功\")\r\n            getCartList(cartData);\r\n        })\r\n})\r\n\r\n//取購物車api\r\nfunction getCartList(){\r\n    axios.get(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts`)\r\n        .then(res=>{\r\n            // console.log(res.data);\r\n            let finalTotal = res.data.finalTotal;\r\n            document.querySelector(\".js-total\").textContent = finalTotal;\r\n            cartData = res.data.carts;\r\n            renderCart(cartData);\r\n        })\r\n}\r\n\r\nconst cartList = document.querySelector(\".shoppingCart-tableList\");\r\n\r\nfunction renderCart(data){\r\n    let str = '';\r\n    data.forEach(item=>{\r\n        let content = `<tr>\r\n            <td>\r\n                <div class=\"cardItem-title\">\r\n                    <img src=\"${item.product.images}\" alt=\"\">\r\n                    <p>${item.product.title}</p>\r\n                </div>\r\n            </td>\r\n            <td>${item.product.price}</td>\r\n            <td>${item.quantity}</td>\r\n            <td>${item.product.price * item.quantity}</td>\r\n            <td class=\"discardBtn\">\r\n                <a href=\"#\" class=\"material-icons\" data-id=\"${item.id}\">\r\n                    clear\r\n                </a>\r\n            </td>\r\n        </tr>`\r\n        str+=content;\r\n    })\r\n    \r\n    cartList.innerHTML = str;\r\n}\r\n\r\n//刪除購物車單一品項\r\ncartList.addEventListener('click',(e)=>{\r\n    e.preventDefault();\r\n    // console.log(e.target)\r\n    const cartId = e.target.getAttribute('data-id');\r\n    if(cartId == null){\r\n        return;\r\n    }\r\n    // console.log(cartId)\r\n\r\n    axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts/${cartId}`)\r\n        .then(res=>{\r\n            alert(\"刪除成功\")\r\n            getCartList()\r\n        })\r\n})\r\n\r\n//刪除整個購物車\r\nconst discardAllBtn = document.querySelector(\".discardAllBtn\");\r\n\r\ndiscardAllBtn.addEventListener('click',(e)=>{\r\n    e.preventDefault();\r\n    axios.delete(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/carts`)\r\n        .then(res=>{\r\n            alert(\"全部刪除成功\")\r\n            getCartList();\r\n        })\r\n        .catch(err=>{\r\n            alert(\"已清空，請勿重複刪除\")\r\n            getCartList();\r\n        })\r\n})\r\n\r\n////加入預定訂單\r\n\r\nconst orderInfoBtn = document.querySelector(\".orderInfo-btn\");\r\norderInfoBtn.addEventListener(\"click\",(e)=>{\r\n    e.preventDefault();\r\n    // console.log(e.target)\r\n    if(cartData.length ==0){\r\n        alert(\"請加入購物車\");\r\n        return;\r\n    }\r\n\r\n    const customerName = document.querySelector(\"#customerName\").value;\r\n    const customerPhone = document.querySelector(\"#customerPhone\").value;\r\n    const customerEmail = document.querySelector(\"#customerEmail\").value;\r\n    const customerAddress = document.querySelector(\"#customerAddress\").value;\r\n    const customerTradeWay = document.querySelector(\"#tradeWay\").value;\r\n    if(customerName==\"\"||customerAddress==\"\"||customerPhone==\"\"||customerEmail==\"\"||customerTradeWay==\"\"){\r\n        alert(\"請輸入訂單資訊\")\r\n        return;\r\n    }\r\n\r\n    const orderForm = document.querySelector(\".orderInfo-form\");\r\n\r\n    axios.post(`https://livejs-api.hexschool.io/api/livejs/v1/customer/${api_path}/orders`,{\r\n        \"data\": {\r\n            \"user\": {\r\n            \"name\": customerName,\r\n            \"tel\": customerPhone,\r\n            \"email\": customerEmail,\r\n            \"address\": customerAddress,\r\n            \"payment\": customerTradeWay\r\n            }\r\n        }\r\n    }).then(res=>{\r\n        alert(\"訂單建立成功\")\r\n        orderForm.reset();\r\n        getCartList();\r\n    })\r\n})\r\n"],"file":"index.js"}